---
layout: docwithnav
title: Nevox LoRaWAN Devices and ThingsBoard

---

* TOC
{:toc}

Netvox has more than 400 LoRaWAN end devices, which can be organized by systems that support LoRaWAN protocol and be widely used in IoT solutions. With the integration of data and ThingsBoard, users can easily add visual elements and monitor data through a dashboard. The settings of the TTN industry are as follows:

## Register Nevox devices on a third-party platform

### Create application

1. Log in to the Network Server and click the Applications page.
2. + Add Applications.
3. Enter Application ID and name.
4. Create Applications.

![image](/images/samples/moko-smart/add-gateway-on-ttn-1.png)

### Register End Device

1. Click the End devices page.
2. + Register end device.
3. Fill in the Netvox Device Information.
    • End device brand: Netvox Technology Co., Ltd
    • Model: Select the device model.
    • Hardware Ver: Automatically generated by the system. 
    • Firmware Ver: Automatically generated by the system.
    • Profile (Region): Select the device’s frequency, such as AS923.
4. Enter JoinEUI and click Confirm.
5. Register end device
6. Check if the information is correct after the device is successfully registered.

![image](/images/samples/moko-smart/add-gateway-on-ttn-2.png)

### 2-3 Network Joining

Turn on the device and make sure it is connected to the Network Server.
Please go to 4-1 Operation or our official website http://www.netvox.com.tw/index.html for detailed info about turning on a device.

![image](/images/samples/moko-smart/add-gateway-on-ttn-3.png)

## Connect to the ThingsBoard

### Create Integration in ThingsBoard

- Sign up and log in to ThingsBoard. Go to the "**Integrations**" page of the "**Integrations center**" section. Click "**plus**" icon in the upper right corner to add new integration. Select "**The Things Stack Community**" as the integration type. Then, click "**Next**".

![image](/images/samples/moko-smart/create-integration-in-thingsboard-1.png)

- Use the default Decoder function. Click "**Next**".


![image](/images/samples/moko-smart/create-integration-in-thingsboard-2.png)

- Use the default Encoder function. Click "**Next**".

![image](/images/samples/moko-smart/create-integration-in-thingsboard-3.png)

- Next, fill in the fields with your parameters. After, press "**Add**" button.
  (6) Enter the third platform’s MQTT account and password.
  (7) Check connect: After a connection is successfully made, the info in the third platform will be transferred to ThingBoard.

![image](/images/samples/moko-smart/create-integration-in-thingsboard-4.png)

(8) Add: Click Add.

### Import the Device List
1. Select Devices in the sidebar.
2. Click Reload and check if the device’s info appears on the list. (If the device’s info does not show on the list, please reboot the device.)
3. Click Latest telemetry to check the latest data.

![image](/images/samples/moko-smart/add-gateway-on-ttn-4.png)


### Create Dashboards
- Go to the "Dashboards" page;
- Click + to create new dashboards
- Enter the device information and click Add.
- Add new widget
- Select a widget to the dashboard, such as the bar chart of the device’s current.  
- Edit the value presented on the bar chart.
- Dashboard created successfully. 

![image](/images/samples/moko-smart/add-gateway-on-ttn-5.png)

## Nevox Devices

### Operation

![image](/images/samples/moko-smart/add-gateway-on-ttn-8.png)

| **Model**                                                               | **Power Supply**                         | **Turn on**                                                                                                              |
|:------------------------------------------------------------------------|:-----------------------------------------|:-------------------------------------------------------------------------------------------------------------------------|
| R311 Series, <br> R312 Series R313 Series                               | Battery                                  | Short press any function key till green and red indicator flashes once. Ex. R311A, R311B, R313CB, R313DA, R312A          |
| R711, R315 Series                                                       | Battery                                  | Short press the function key and the green indicator flashes once. Ex. R711, R31501, R315LA                              |
| R718 Series, R720 Series, RA08B Series                                  | Battery                                  | Press and hold the function key for 3 seconds till the green indicator flashes once. Ex. R718N37, R718H, R720A, RA08B01S |
| R718 Series, R831 Series, RA08D Series,RA07 Series RA07xxY Series, R211 | DC in                                    | Plug in the power adapter. Ex. R718N37D, R718PC, RA08D09S, RA0715, RA0716Y, R831C                                        |
| R726 Series                                                             | solar and rechargeable lithium batteries | Connect a battery pack. Ex. R72601, R72610, R72630                                                                       |
| R60 Series                                                              | DC in                                    | Plug in the power adapter. Ex. R602A, R602B, R603                                                                        |
| RA02 Series                                                             | Battery                                  | Press any function key until the green indicator flashes once. Ex. RA02A, RA02C                                          |
| RA02 Series                                                             | DC in                                    | Plug in the power adapter. Ex. RA02G, RA02D1                                                                             |
| RB02 Series                                                             | Battery                                  | Press the function key till seeing one green indicator flash and one red indicator flash. Ex. RB02B, RB02C, RB02I        |
| R309                                                                    | Battery                                  | Press and hold the emergency button for 3 seconds until the green/red indicator flashes once. Ex. R30901, R30902         |
| R719A                                                                   | Battery                                  | The magnet approach to the top cover for 3 seconds.                                                                      |
| RP02 Series                                                             | DC in                                    | Connect a power module Ex. RP02RH3PN063                                                                                  |
| R809 Series                                                             | AC100-240V                               | Connect to an AC 100-240V power source. Ex. R809A, R809A01                                                               |
| R816 Series                                                             | AC 100-240V                              | Connect to an AC 100-240V power source. Ex. R816A, R816A01                                                               |
| ---                                                                     

*For more detailed information, please go to http://www.netvox.com.tw/index.html.

### Data-converters

The original document of ThingsBoard data converter:

https://github.com/thingsboard/data-converters/tree/main/VENDORS/Netvox

![image](/images/samples/netvox/4-2-1.png)


<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

### Create Integration in ThingsBoard

- Go to the "**Integrations**" page of the "**Integrations center**" section. Click "**plus**" icon in the upper right corner to add new integration. Select "**The Things Stack Community**" as the integration type. Then, click "**Next**".

![image](/images/samples/moko-smart/create-integration-in-thingsboard-1.png)

- Paste the following script to the Decoder function section. Click "**Next**".

```js
var data = decodeToJson(payload);

var deviceName = data.end_device_ids.device_id;
var deviceType = data.end_device_ids.application_ids.application_id;

// If you want to parse incoming data somehow, you can add your code to this function.
// input: bytes
// expected output:
//  {
//    "attributes": {"attributeKey": "attributeValue"},
//    "telemetry": {"telemetryKey": "telemetryValue"}
//  }
// default functionality - convert bytes to HEX string with telemetry key "HEX_bytes"

function decodeFrmPayload(input) {
    var output = { attributes:{}, telemetry: {} };
    // --- Decoding code --- //

    output.telemetry.HEX_bytes = bytesToHex(input);

    // --- Decoding code --- //
    return output;
}

// --- attributes and telemetry objects ---
var telemetry = {};
var attributes = {};
// --- attributes and telemetry objects ---

// --- Timestamp parsing
var incomingDateString = data.uplink_message.received_at;
var dateString = incomingDateString.substring(0, incomingDateString.lastIndexOf(".")+3) + "Z";
var timestamp = new Date(dateString).getTime();
// --- Timestamp parsing

// You can add some keys manually to attributes or telemetry
attributes.f_port = data.uplink_message.f_port;
attributes.settings = data.uplink_message.settings;
// We want to save correlation ids as single object, so we are excluding them from attributes parse and add manually
attributes.correlation_ids = data.correlation_ids;

// You can exclude some keys from the result
var excludeFromAttributesList = ["device_id", "application_id", "uplink_message", "correlation_ids"];
var excludeFromTelemetryList = ["uplink_token", "gateway_id", "settings"];

// Message parsing
// To avoid paths in the decoded objects we passing false value to function as "pathInKey" argument.
// Warning: pathInKey can cause already found fields to be overwritten with the last value found, e.g. receive_at from uplink_message will be written receive_at in the root.
var telemetryData = toFlatMap(data.uplink_message, excludeFromTelemetryList, false);
var attributesData = toFlatMap(data, excludeFromAttributesList, false);

// Passing incoming bytes to decodeFrmPayload function, to get custom decoding
var customDecoding = {};
if (data.uplink_message.get("frm_payload") != null) {
    customDecoding = decodeFrmPayload(base64ToBytes(data.uplink_message.frm_payload));
}

// Collecting data to result
if (customDecoding.?telemetry.size() > 0) {
    telemetry.putAll(customDecoding.telemetry);
}

if (customDecoding.?attributes.size() > 0) {
    attributes.putAll(customDecoding.attributes);
}

telemetry.putAll(telemetryData);
attributes.putAll(attributesData);

var result = {
    deviceName: deviceName,
    deviceType: deviceType,
    telemetry: {
        ts: timestamp,
        values: telemetry
    },
    attributes: attributes
};

return result;
```
{:.copy-code.expandable-15}

![image](/images/samples/moko-smart/create-integration-in-thingsboard-2.png)

- Leave the "**Downlink data converter**" field empty. Click on "**Skip**" button.

![image](/images/samples/moko-smart/create-integration-in-thingsboard-3.png)

- Next, fill in the fields with your parameters. After, press "**Add**" button.

![image](/images/samples/moko-smart/create-integration-in-thingsboard-4.png)

## Add Device

**Step 1**:
- Go to the application console - "End devices" page;
- Click "Register end device".

![image](/images/samples/moko-smart/add-device-1.png)

<br>

**Step 2**:
- Choose enter end device specifies manually;
- Select frequency plan (the frequency plan should be totally same as your gateway frequency plan);
- Select LoRaWan version as v1.0.3.

![image](/images/samples/moko-smart/add-device-2.png)

<br>

**Step 3**: Enter the JoinEUI, MOKO device default JoinEUI is 70 B3 D5 7E D0 02 6B 87

**Step 4**: After JoinEUI is confirmed, enter the DevEUI and AppKEY, for MOKO device, you can get the DevEUI on the package label, and the AppKEY for device is 2B 7E 15 16 28 AE D2 A6 AB F7 15 88 09 CF 4F 3C by default. Or you can connect to the device via “MKLora” APP and read the DevEUI and AppKEY from the APP.

![image](/images/samples/moko-smart/add-device-3.png)

<br>

**Step 5**: Click Register end device to finish.

**Step 6**: Check the status of device on TTN.

![image](/images/samples/moko-smart/add-device-4.png)

<br>

And you can also check the live data, if there is payload uploaded means the device already connect to the server.

![image](/images/samples/moko-smart/add-device-5.png)

<br>

**Step 7**: Navigate to Payload formatters, get the decoder from the [moko github_link](https://github.com/LoRaWAN-Product-Decoder/MOKOSMART-LoRaWAN-Product-Decoder/tree/main/LW006){:target="_blank"}, copy the related decoder and paste it. And then save it.

![image](/images/samples/moko-smart/add-device-6.png)

<br>

**Step 8**: Navigate to the "**Devices**" page of the "**Entities**" section, here you can see that:

- Devices registered in TTN were registered in ThingsBoard in the "Latest telemetry" section you will the update data from the device.

![image](/images/samples/moko-smart/add-device-7.png)

## Add Dashboard

A dashboard in ThingsBoard allows users to visualize and monitor data collected from IoT devices. Let's create a dashboard and add two widgets to it:

- The first widget will show the device's battery level.
- The second widget will display the device's location on a map.

### Add Dashboard

{% assign addindDashboard = '
===
image: /images/samples/moko-smart/add-dashboard-1.png,
title: Navigate to the "**Dashboards**" page through the main menu on the left of the screen. Click the "**+**" sign in the upper right corner of the screen, and select "**Create new dashboard**" from the drop-down menu. In the opened dialog, it is necessary to enter a dashboard title, description is optional. Click "**Add**";
'
%}

{% include images-gallery.liquid showListImageTitles="true" imageCollection=addindDashboard %}

### Add Battery level widget

{% assign addingBatteryLevelWidget = '
===
image: /images/samples/moko-smart/add-widget-1.png,
title: Click the "**+ Add widget**" button at the top of the screen or click the large "**Add new widget**" icon in the center of the screen (if this is your first widget on this dashboard);
===
image: /images/samples/moko-smart/add-widget-2.png,
title: Find the "**Status indicators**" widget bundle and click on it;
===
image: /images/samples/moko-smart/add-widget-3.png,
title: Select the "**Battery level**" widget;
===
image: /images/samples/moko-smart/add-widget-4.png,
title: The "Add widget" window will appear. Specify the "**lw006test**" device as the datasource and "**batt_level**" data ket as the variable that you want to monitor. Click "**Add**";
===
image: /images/samples/moko-smart/add-widget-5.png,
title: You have added a widget that displays the battery level.
'
%}

{% include images-gallery.liquid showListImageTitles="true" imageCollection=addingBatteryLevelWidget %}

### Add Map widget

{% assign addingMapWidget = '
===
image: /images/samples/moko-smart/add-widget-6.png,
title: Click the "**+ Add widget**" button at the top of the screen to add another one widget;
===
image: /images/samples/moko-smart/add-widget-7.png,
title: Find the "**Maps**" widget bundle and click on it;
===
image: /images/samples/moko-smart/add-widget-8.png,
title: Select the "**Google map**" widget;
===
image: /images/samples/moko-smart/add-widget-9.png,
title: The "Add widget" window will appear. Select "Device" as the datasource type. Specify the "**lw006test**" device as the datasource. Add "**latitude**" and "**longitude**" as time series data keys. Click "**Add**";
===
image: /images/samples/moko-smart/add-widget-10.png,
title: To save the dashboard, click "**Save**" button in the upper right corner;
===
image: /images/samples/moko-smart/add-widget-11.png,
title: You have added a widget that displays the device&#39;s location on a map.
'
%}

{% include images-gallery.liquid showListImageTitles="true" imageCollection=addingMapWidget %}

## Next steps

{% assign currentGuide = "HardwareSamples" %}{% include templates/guides-banner.md %}